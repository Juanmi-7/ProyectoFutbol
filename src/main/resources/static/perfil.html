<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>App CD Genoves</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link href="./css/estilo.css" rel="stylesheet" type="text/css">
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"></script>
</head>
<body>
	<header>
		<h1>CD Genovés</h1>
		<img src="./img/escudo.png" alt="Escudo" title="Escudo" class="escudo">
	</header>
	<div id="menu_navegacion">
		<nav class="navegacion">
			<div class="navegacion_menu">
				<a href="#" class="enlace_menu"><i class="fa fa-bars"></i></a>
				<ul class="navegacion_menu_lista">
					<li><a id="inicio" class="active" href="index.html">Inicio</a></li>
					<li><a id="estadisticas" href="estadisticas.html">Estadísticas</a></li>
					<li><a id="convocatoria" href="convocatoria.html">Convocatoria</a></li>
					<li><a id="resultado" href="resultado.html">Resultado</a></li>
				</ul>
			</div>
			<div>
				<button type="button" id="login">Login</button>
				<button type="button" id="registro">Registro</button>
			</div>
			<div class="navegacion_claro_oscuro">
				<a href="perfil.html" id="perfil"><img src="./img/perfil.jpg" alt="Perfil" title="Perfil" class="perfil"></a>
				<div class="claro_oscuro">
					<button type="button" id="btn_modo_claro"><i class="fa fa-sun"></i>&nbsp;Modo claro</button>
					<button type="button" id="btn_modo_oscuro"><i class="fa fa-moon"></i>&nbsp;Modo oscuro</button>
				</div>
			</div>
		</nav>
	</div>
	<script type="text/javascript">
		let nombre_usuario = "";
		let misCookies = document.cookie.split(";");
		for (i in misCookies) {
			let busca = misCookies[i].search(token);
			if (busca > -1) {micookie=misCookies[i]}
		}
		var igual = micookie.indexOf("=");
		var token = micookie.substring(igual+1);
		
		if (token!="" && token!=null) {
			parseJwt(token);
		}
		else {
			nombre_usuario = null;
		}
		function parseJwt(token) {
			var base64Url = token.split('.')[1];
			var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
			var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
				return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
			}).join(''));
		
			let usuario = JSON.parse(jsonPayload);
			for (j in usuario) {
				if (j=="sub") {nombre_usuario = usuario[j]}
			}
		}
		$("#nombre_usuar").html(nombre_usuario);
	</script>
	<main>
		<div id="contenedor">
			<div class="tarjeta">
				<div class="titulo_tarjeta">
					<div><h3>Perfil:</h3></div>
					<div><h3>Bienvenido <span id="nombre_usuar"></span></h3></div>
				</div>
				<hr>
				<div class="contenido_tarjeta">
					<div class="contenido_usuario">
						<label for="nombre_usuario">Nombre de usuario:</label>
						<input type="text" id="nombre_usuario" readonly><br><br>
						<label for="clave">Clave:</label>
						<input type="password" id="clave" required>
					</div><br>
					<div style="display:flex;justify-content: space-between;">
						<div>
							<button type="button" id="actualizar" class="anadir"><i class="fas fa-edit"></i> Actualizar datos</button>
							<button type="button" id="eliminar" class="eliminar"><i class="fas fa-trash"></i> Borrar usuario</button>
						</div>
						<div>
							<button type="button" id="logout" class="eliminar"><i class="fa fa-arrow-right"></i> Logout</button>
						</div>
					</div><br><br>
					<div id="salida"></div>
				</div>
			</div>
		</div>
	</main>
	<footer>
		<nav class="pie">
			<ul>
				<li><a href="#">Aviso legal</a></li>
				<li><a href="#">Política de privacidad</a></li>
				<li><a href="#">Política de cookies</a></li>
				<li><a href="#">Contacto</a></li>
			</ul>
		</nav>
		<nav class="pie">
			<ul>
				<li><a href="#" title="Facebook"><i class="fab fa-facebook" style="font-size: 50px; color: rgb(66,103,178);"></i></a></li>
				<li><a href="#" title="Twitter"><i class="fab fa-twitter" style="font-size: 50px; color: rgb(29,161,242);"></i></a></li>
				<li><a href="#" title="Instagram"><i class="fab fa-instagram" style="font-size: 50px; color: rgb(225,48,108);"></i></a></li>
				<li><a href="#" title="Pinterest"><i class="fab fa-pinterest" style="font-size: 50px; color: rgb(189,8,28);"></i></a></li>
			</ul>
		</nav>
	</footer>
</body>
<script src="js/scriptperfil.js"></script>
</html>